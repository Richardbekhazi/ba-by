<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Baby ABC</title>
    <!-- Friendly Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@600;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #E0F7FA;
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --accent: #FFE66D;
            --text-main: #2D3436;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(180deg, #E0F7FA 0%, #E3F2FD 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* ✨ PARTICLES CANVAS */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
        }

        /* 🏠 HOME BUTTON */
        .home-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            text-decoration: none;
            box-shadow: 0 4px 0 #cbd5e1;
            border: 2px solid #e2e8f0;
            z-index: 100;
            transition: transform 0.1s;
        }
        .home-btn:active { transform: translateY(4px); box-shadow: none; }

        /* GAME AREA */
        #game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 800px; /* Increased for 3 options */
            padding: 20px;
        }

        #letter-display {
            font-family: 'Fredoka One', cursive;
            font-size: 10rem;
            color: var(--text-main);
            /* Soft playful shadow */
            text-shadow: 4px 4px 0px rgba(0,0,0,0.1);
            margin-bottom: 10px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        #letter-display:active { transform: scale(0.9); }

        .options-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            width: 100%;
            flex-wrap: wrap; /* Safety for small screens */
        }

        .hint-text {
            font-family: 'Fredoka One', cursive;
            color: var(--secondary);
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        .emoji-btn {
            width: 150px;
            height: 180px; /* Taller to fit text */
            background: white;
            border: 6px solid #fff;
            border-radius: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05), 0 6px 0 #e2e8f0;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            user-select: none;
            padding: 10px;
        }

        .emoji-icon {
            font-size: 4.5rem;
            margin-bottom: 5px;
            line-height: 1.1;
        }

        .emoji-text {
            font-family: 'Fredoka One', cursive;
            font-size: 1.2rem;
            color: #636e72;
            text-transform: capitalize;
        }

        .emoji-btn:active {
            transform: scale(0.92) translateY(6px);
            box-shadow: 0 0 0 #e2e8f0;
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .pop-in { animation: popIn 0.5s ease-out forwards; }

        .fade-out {
            opacity: 0;
            transform: scale(0.8);
            pointer-events: none;
            transition: all 0.3s;
        }

        .celebrate {
            background-color: var(--secondary) !important;
            border-color: var(--secondary) !important;
            transform: scale(1.1) !important;
            box-shadow: 0 0 30px var(--secondary) !important;
        }
        
        .celebrate .emoji-text {
             color: white;
        }

    </style>
</head>
<body>

    <canvas id="particles"></canvas>
    
    <a href="/" class="home-btn" title="Back to Games">🏠</a>

    <div id="game-area">
        <div id="letter-display">A</div>
        <div class="hint-text">Find the...</div>
        <div class="options-container" id="options">
            <!-- Options injected here -->
        </div>
    </div>

    <script>
        const alphabet = [
            { L: 'A', e: '🍎', w: 'Apple' },
            { L: 'B', e: '🐻', w: 'Bear' },
            { L: 'C', e: '🐱', w: 'Cat' },
            { L: 'D', e: '🐶', w: 'Dog' },
            { L: 'E', e: '🐘', w: 'Elephant' },
            { L: 'F', e: '🐟', w: 'Fish' },
            { L: 'G', e: '🍇', w: 'Grapes' },
            { L: 'H', e: '🏠', w: 'House' },
            { L: 'I', e: '🍦', w: 'Ice Cream' },
            { L: 'J', e: '🚙', w: 'Jeep' },
            { L: 'K', e: '🔑', w: 'Key' },
            { L: 'L', e: '🦁', w: 'Lion' },
            { L: 'M', e: '🌙', w: 'Moon' },
            { L: 'N', e: '👃', w: 'Nose' },
            { L: 'O', e: '🍊', w: 'Orange' },
            { L: 'P', e: '🐷', w: 'Pig' },
            { L: 'Q', e: '👑', w: 'Queen' },
            { L: 'R', e: '🌈', w: 'Rainbow' },
            { L: 'S', e: '⭐', w: 'Star' },
            { L: 'T', e: '🚂', w: 'Train' },
            { L: 'U', e: '☂️', w: 'Umbrella' },
            { L: 'V', e: '🎻', w: 'Violin' },
            { L: 'W', e: '🐳', w: 'Whale' },
            { L: 'X', e: '🦴', w: 'X-Ray' },
            { L: 'Y', e: '📒', w: 'Yellow' },
            { L: 'Z', e: '🦓', w: 'Zebra' }
        ];

        let current;
        let canClick = false;
        let roundCounter = 0;

        const gameArea = document.getElementById('game-area');
        const letterDisplay = document.getElementById('letter-display');
        const hintText = document.querySelector('.hint-text');
        const optionsDiv = document.getElementById('options');

        // Simple Text to Speech
        function say(text) {
            window.speechSynthesis.cancel(); 
            const u = new SpeechSynthesisUtterance(text);
            // Try to find a friendly voice
            const voices = window.speechSynthesis.getVoices();
            const preferred = voices.find(v => v.name.includes('Google US English')) || 
                              voices.find(v => v.name.includes('Samantha')) || 
                              voices[0];
            if(preferred) u.voice = preferred;
            
            u.rate = 0.9; 
            u.pitch = 1.1; 
            window.speechSynthesis.speak(u);
        }

        // Tap the big letter to hear it again
        letterDisplay.addEventListener('click', () => {
            if(current) {
                say(current.L);
                // Mini pulse animation
                letterDisplay.style.transform = "scale(1.2)";
                setTimeout(() => letterDisplay.style.transform = "scale(1)", 200);
            }
        });

        function nextRound() {
            canClick = true;
            
            // Pick next letter in sequence or random? Let's do random but avoid immediate repeats
            let idx;
            do {
                idx = Math.floor(Math.random() * alphabet.length);
            } while (current && alphabet[idx].L === current.L);
            current = alphabet[idx];
            // Setup Visuals
            letterDisplay.innerText = current.L;
            letterDisplay.style.color = getRandomPastelColor();
            letterDisplay.classList.remove('pop-in');
            void letterDisplay.offsetWidth; // trigger reflow
            letterDisplay.classList.add('pop-in');
            
            hintText.innerText = `Find the ${current.w}...`;

            // Say Prompt
            setTimeout(() => say(`${current.L} is for ${current.w}. Can you find the ${current.w}?`), 300);

            // Prepare options (1 right, 2 wrong)
            let wrongIdx1, wrongIdx2;
            do {
                wrongIdx1 = Math.floor(Math.random() * alphabet.length);
            } while (wrongIdx1 === idx);
            
            do {
                wrongIdx2 = Math.floor(Math.random() * alphabet.length);
            } while (wrongIdx2 === idx || wrongIdx2 === wrongIdx1);

            const wrong1 = alphabet[wrongIdx1];
            const wrong2 = alphabet[wrongIdx2];
            
            // Randomize order
            const choices = [current, wrong1, wrong2];
            // Shuffle
            for (let i = choices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [choices[i], choices[j]] = [choices[j], choices[i]];
            }

            optionsDiv.innerHTML = '';
            
            choices.forEach((item, index) => {
                const btn = document.createElement('div');
                btn.className = 'emoji-btn pop-in';
                btn.style.animationDelay = `${index * 0.1}s`;
                
                // Icon and Text
                const iconDiv = document.createElement('div');
                iconDiv.className = 'emoji-icon';
                iconDiv.innerText = item.e;
                
                const textDiv = document.createElement('div');
                textDiv.className = 'emoji-text';
                textDiv.innerText = item.w;
                
                btn.appendChild(iconDiv);
                btn.appendChild(textDiv);
                
                // Interaction
                const handleChoice = (e) => {
                    e.preventDefault(); // Stop double firing
                    if (!canClick && !btn.classList.contains('fade-out')) return; 

                    // Say the name of whatever was pressed!
                    say(item.w);

                    if (item === current) {
                        // Correct!
                        if (!canClick) return; 
                        
                        canClick = false;
                        btn.classList.add('celebrate');
                        
                        // Big Particle Explosion
                        const rect = btn.getBoundingClientRect();
                        for(let i=0; i<3; i++) {
                            setTimeout(() => createExplosion(rect.left + rect.width/2, rect.top + rect.height/2, getRandomPastelColor()), i * 200);
                        }
                        
                        setTimeout(nextRound, 2500);
                    } else {
                        // Wrong
                        if (!canClick) return; 
                        
                        btn.classList.add('fade-out');
                    }
                };

                btn.addEventListener('click', handleChoice);
                btn.addEventListener('touchstart', handleChoice, {passive: false});
                
                optionsDiv.appendChild(btn);
            });
        }

        function getRandomPastelColor() {
            const colors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#FF9F43', '#A29BFE'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // --- PARTICLE SYSTEM (Reused from other games) ---
        const canvas = document.getElementById('particles');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function setupCanvas() {
            const resize = () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            };
            window.addEventListener('resize', resize);
            resize();
            animateParticles();
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x; this.y = y;
                this.color = color;
                this.size = Math.random() * 8 + 4; 
                this.speedX = Math.random() * 6 - 3;
                this.speedY = Math.random() * 6 - 3;
                this.life = 100;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.speedY += 0.2; 
                this.life -= 2;
                this.size *= 0.95;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function createExplosion(x, y, color) {
            for (let i = 0; i < 30; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animateParticles);
        }
        
        // Init Sound on click if needed
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = () => {};
        }

        setupCanvas();
        // Start immediately
        nextRound();

    </script>
</body>
</html>