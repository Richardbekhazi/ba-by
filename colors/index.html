<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jelly Colors</title>
    <!-- Friendly Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@600;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #f7f9fc;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Fredoka One', cursive;
            background-color: var(--bg-color);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* ✨ PARTICLES CANVAS */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
        }

        /* 🏠 HOME BUTTON */
        .home-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            text-decoration: none;
            box-shadow: 0 4px 0 #cbd5e1;
            border: 2px solid #e2e8f0;
            z-index: 100;
            transition: transform 0.1s;
        }
        .home-btn:active { transform: translateY(4px); box-shadow: none; }

        /* HEADER */
        .header {
            text-align: center;
            padding-top: 20px;
            margin-bottom: 10px;
            z-index: 10;
            flex-shrink: 0;
        }
        h1 {
            color: #2d3436;
            margin: 0;
            font-size: 2rem;
            letter-spacing: 1px;
        }
        p {
            font-family: 'Nunito', sans-serif;
            color: #636e72;
            margin: 5px 0 0 0;
            font-weight: 800;
        }

        /* 🎹 PAD GRID CONTAINER */
        .grid-container {
            flex: 1;
            overflow-y: auto; /* Scrollable for many colors */
            -webkit-overflow-scrolling: touch;
            padding: 10px;
            padding-bottom: 40px;
            width: 100%;
        }

        .pad-grid {
            display: grid;
            /* Adaptive grid: big buttons */
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            max-width: 1000px;
            margin: 0 auto;
        }

        /* BLOB PAD */
        .color-pad {
            position: relative;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            aspect-ratio: 1;
            transition: transform 0.1s;
            -webkit-tap-highlight-color: transparent;
        }

        .color-pad:active, .color-pad.active {
            transform: scale(0.95);
        }

        /* The SVG Blob Background */
        .pad-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            filter: drop-shadow(0 6px 0 rgba(0,0,0,0.1));
            transition: filter 0.1s;
        }
        
        .color-pad:active .pad-bg, .color-pad.active .pad-bg {
            filter: drop-shadow(0 2px 0 rgba(0,0,0,0.1));
        }

        /* The Label inside the pad */
        .pad-label {
            position: relative;
            font-size: 1.8rem;
            color: white;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
            pointer-events: none;
            z-index: 2;
            text-transform: capitalize;
        }

        /* Dark text for light colors */
        .color-pad.dark-text .pad-label {
            color: #2d3436;
            text-shadow: none;
        }

        /* Ripple effect container */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: scale(0);
            animation: rippleAnim 0.6s linear;
            pointer-events: none;
            z-index: 3;
        }

        @keyframes rippleAnim {
            to { transform: scale(3); opacity: 0; }
        }

    </style>
</head>
<body>

    <canvas id="particles"></canvas>
    <a href="/" class="home-btn" title="Back to Games">🏠</a>

    <div class="header">
        <h1>Jelly Colors 🎨</h1>
        <p>Tap the blobs!</p>
    </div>

    <div class="grid-container">
        <div class="pad-grid" id="grid">
            <!-- Pads injected via JS -->
        </div>
    </div>

    <script>
        /**
         * JELLY COLORS v2
         * - Organic Blob Shapes
         * - 24 Colors
         * - Musical Scale Mapping
         */

        // Musical Notes (C Major Scale over 3 Octaves)
        // C3 to B5
        const NOTES = [
            130.81, 146.83, 164.81, 174.61, 196.00, 220.00, 246.94, // Octave 3
            261.63, 293.66, 329.63, 349.23, 392.00, 440.00, 493.88, // Octave 4
            523.25, 587.33, 659.25, 698.46, 783.99, 880.00, 987.77, // Octave 5
            1046.50, 1174.66, 1318.51 // Octave 6 Start
        ];

        const COLORS = [
            { name: 'Red', hex: '#FF5252' },
            { name: 'Orange', hex: '#FF9800' },
            { name: 'Yellow', hex: '#FFEB3B', darkText: true },
            { name: 'Lime', hex: '#CDDC39', darkText: true },
            { name: 'Green', hex: '#4CAF50' },
            { name: 'Teal', hex: '#009688' },
            
            { name: 'Cyan', hex: '#00BCD4' },
            { name: 'Sky', hex: '#81D4FA', darkText: true },
            { name: 'Blue', hex: '#2196F3' },
            { name: 'Navy', hex: '#3F51B5' },
            { name: 'Indigo', hex: '#303F9F' },
            { name: 'Violet', hex: '#673AB7' },
            
            { name: 'Purple', hex: '#9C27B0' },
            { name: 'Magenta', hex: '#E91E63' },
            { name: 'Pink', hex: '#F48FB1' },
            { name: 'Rose', hex: '#FF4081' },
            { name: 'Coral', hex: '#FF7043' },
            { name: 'Brown', hex: '#795548' },
            
            { name: 'Tan', hex: '#D7CCC8', darkText: true },
            { name: 'Gold', hex: '#FFD700', darkText: true },
            { name: 'Silver', hex: '#BDBDBD', darkText: true },
            { name: 'Gray', hex: '#607D8B' },
            { name: 'Black', hex: '#212121' },
            { name: 'White', hex: '#FFFFFF', darkText: true }
        ];

        // Organic Blob Paths (Normalized for 100x100 viewbox)
        const BLOBS = [
            "M43.6,-53.4C55.3,-41.2,62.8,-27.1,65.3,-12.1C67.8,2.9,65.2,18.7,56.7,31.5C48.2,44.3,33.8,54.1,18.4,59.3C3,64.5,-13.4,65.2,-28.4,59.3C-43.4,53.4,-57,41,-63.9,26.1C-70.8,11.2,-71,-6.2,-63.4,-20.9C-55.8,-35.6,-40.4,-47.6,-25.9,-58.1C-11.4,-68.6,2.2,-77.6,15.8,-76.8C29.4,-76,43,-65.4,43.6,-53.4Z",
            "M45.7,-51.7C58.9,-40.8,69.1,-27.2,71.2,-12.6C73.3,2,67.3,17.6,58.3,31.3C49.3,45,37.3,56.8,23.3,62.1C9.3,67.4,-6.7,66.2,-21.2,59.9C-35.7,53.6,-48.7,42.2,-56.3,28.6C-63.9,15,-66.1,-0.8,-61.6,-14.8C-57.1,-28.8,-45.9,-41,-33.5,-52.1C-21.1,-63.2,-7.5,-73.2,3.3,-77.1C14.1,-81.1,28.2,-79,32.5,-62.6",
            "M39.5,-47.7C51.2,-37.2,60.8,-25.1,64.8,-11.2C68.8,2.7,67.2,18.4,59.1,31.2C51,44,36.4,53.9,21.1,58.6C5.8,63.3,-10.2,62.8,-24.6,56.9C-39,51,-51.8,39.7,-58.3,26.1C-64.8,12.5,-65,-3.4,-59.4,-17.4C-53.8,-31.4,-42.4,-43.5,-29.9,-53.6C-17.4,-63.7,-3.8,-71.8,5.1,-77.9C14,-84,27.8,-60,39.5,-47.7Z",
            "M41.7,-50.2C54.7,-41.6,66.3,-30.3,70.6,-16.9C74.9,-3.5,71.9,12,63.9,25.4C55.9,38.8,42.9,50.1,28.6,56.7C14.3,63.3,-1.3,65.2,-15.6,61.7C-29.9,58.2,-42.9,49.3,-52.6,37.6C-62.3,25.9,-68.7,11.4,-66.2,-1.7C-63.7,-14.8,-52.3,-26.5,-41.4,-35.6C-30.5,-44.7,-20.1,-51.2,-7.9,-51.2C4.3,-51.2,28.7,-58.8,41.7,-50.2Z"
        ];

        const grid = document.getElementById('grid');
        
        // --- Audio Context ---
        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playTone(freq) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();

            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            
            gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);

            osc.connect(gain);
            gain.connect(audioCtx.destination);

            osc.start();
            osc.stop(audioCtx.currentTime + 0.4);
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = window.speechSynthesis.getVoices();
            const preferred = voices.find(v => v.name.includes('Google US English')) || voices[0];
            if(preferred) utterance.voice = preferred;
            utterance.rate = 1.0;
            utterance.pitch = 1.2;
            window.speechSynthesis.speak(utterance);
        }

        // --- Setup ---

        function init() {
            COLORS.forEach((color, index) => {
                const btn = document.createElement('button');
                btn.className = 'color-pad';
                if(color.darkText) btn.classList.add('dark-text');
                
                // Cycle through blob shapes
                const blobPath = BLOBS[index % BLOBS.length];
                const note = NOTES[index % NOTES.length];

                // Create SVG Blob Background
                // Scale path to fit roughly in 0 0 100 100 but centered
                btn.innerHTML = `
                    <svg class="pad-bg" viewBox="-80 -80 160 160">
                        <path d="${blobPath}" fill="${color.hex}" />
                    </svg>
                    <div class="pad-label">${color.name}</div>
                `;

                // Interactions
                const activate = (e) => {
                    e.preventDefault(); 
                    e.stopPropagation();
                    triggerPad(btn, color, note, e);
                };

                btn.addEventListener('touchstart', activate, {passive: false});
                btn.addEventListener('mousedown', activate);

                grid.appendChild(btn);
            });
        }

        function triggerPad(btn, color, note, e) {
            // Visual feedback
            btn.classList.add('active');
            setTimeout(() => btn.classList.remove('active'), 150);

            // Audio
            playTone(note);
            speak(color.name);

            // Particles
            const rect = btn.getBoundingClientRect();
            let x, y;
            if (e.type === 'touchstart') {
                x = e.touches[0].clientX;
                y = e.touches[0].clientY;
            } else {
                x = e.clientX;
                y = e.clientY;
            }
            if (!x) { x = rect.left + rect.width/2; y = rect.top + rect.height/2; }

            createExplosion(x, y, color.hex);

            // Ripple
            const ripple = document.createElement('div');
            ripple.className = 'ripple';
            const size = Math.max(rect.width, rect.height);
            ripple.style.width = ripple.style.height = `${size}px`;
            ripple.style.left = `${x - rect.left - size/2}px`;
            ripple.style.top = `${y - rect.top - size/2}px`;
            btn.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);
        }

        // --- PARTICLE SYSTEM ---
        const canvas = document.getElementById('particles');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function setupCanvas() {
            const resize = () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            };
            window.addEventListener('resize', resize);
            resize();
            animateParticles();
        }

        class Particle {
            constructor(x, y, color) {
                this.x = x; this.y = y;
                this.color = color;
                this.size = Math.random() * 8 + 4; 
                this.speedX = Math.random() * 8 - 4;
                this.speedY = Math.random() * 8 - 4;
                this.life = 100;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.speedY += 0.2; 
                this.life -= 2;
                this.size *= 0.95;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function createExplosion(x, y, color) {
            for (let i = 0; i < 15; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animateParticles);
        }

        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = () => {};
        }

        setupCanvas();
        init();

    </script>
</body>
</html>